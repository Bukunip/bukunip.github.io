<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Puzzle Premium</title>

<style>
body{
    background:#111;
    color:white;
    text-align:center;
    font-family:Arial;
}

#puzzle{
    width:90vw;
    max-width:400px;
    aspect-ratio:1/1;
    display:grid;
    gap:2px;
    margin:auto;
}

.tile{
    background-image:url("pelacur-berjilbab-hunaifatul-azizah-aini-3.jpg");
    background-size:100% 100%;
    cursor:grab;
    user-select:none;
    transition:0.2s;
}

#downloadBtn{
    display:none;
    margin-top:20px;
    padding:12px 20px;
    font-size:16px;
}
</style>
</head>

<body>

<h2>Puzzle Premium</h2>
<div id="puzzle"></div>
<button id="downloadBtn">Download Gambar</button>

<script>
let level=3;
let size=level;
const puzzle=document.getElementById("puzzle");
const image="images/gambar.jpg";

function shuffle(arr){
    return arr.sort(()=>Math.random()-0.5);
}

function createPuzzle(){
    puzzle.innerHTML="";

    let tiles=[...Array(size*size).keys()];
    tiles=shuffle(tiles);

    puzzle.style.gridTemplateColumns=`repeat(${size},1fr)`;

    let tileSize=400/size;

    tiles.forEach((pos,i)=>{
        let tile=document.createElement("div");
        tile.className="tile";

        let row=Math.floor(pos/size);
        let col=pos%size;

        tile.style.width="100%";
        tile.style.height="100%";
        tile.style.backgroundImage=`url(${image})`;
        tile.style.backgroundPosition=
        `${(col*100)/(size-1)}% ${(row*100)/(size-1)}%`;

        tile.draggable=true;

        tile.addEventListener("dragstart",e=>{
            e.dataTransfer.setData("text",i);
        });

        tile.addEventListener("dragover",e=>{
            e.preventDefault();
        });

        tile.addEventListener("drop",e=>{
            e.preventDefault();
        });

        puzzle.appendChild(tile);
    });
}

createPuzzle();

document.getElementById("downloadBtn").onclick=function(){
    let a=document.createElement("a");
    a.href=image;
    a.download="puzzle-result.jpg";
    a.click();
};
</script>

</body>
</html>
